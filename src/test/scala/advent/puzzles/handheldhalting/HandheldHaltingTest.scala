package advent.puzzles.handheldhalting

import advent.utils.InputParser
import org.scalatest.wordspec.AnyWordSpec
import org.scalatest.matchers.should.Matchers

class HandheldHaltingTest extends AnyWordSpec with Matchers {

  "HandheldHaltingTest" when {
    "accumulateUntilHalt" should {
      "return the accumulator after running example program" in {
        HandheldHalting.accumulateUntilHalt(
          InputParser.parse[String]("nop +0\nacc +1\njmp +4\nacc +3\njmp -3\nacc -99\nacc +1\njmp -4\nacc +6")
        ) should be(5)
      }

      "return the accumulator after running puzzle program" in {
        HandheldHalting.accumulateUntilHalt(
          InputParser.parse[String](
            "jmp +11\nnop +495\nnop +402\njmp +570\njmp +569\njmp +451\nacc -12\njmp +364\nacc +30\nacc +21\njmp +430\njmp +87\nacc -12\nacc -4\nacc +11\njmp +50\njmp +149\njmp +341\nnop +1\nacc +33\njmp +461\nacc +43\nacc -15\njmp +440\nacc +18\nacc +22\nacc -14\nnop +576\njmp -22\nacc +33\nacc +0\nacc +34\njmp +369\nnop +497\nnop +469\nacc -12\njmp +93\nacc -13\njmp +337\nacc +5\nacc +18\nacc +26\nnop +115\njmp +67\nnop +282\nnop -6\nnop +289\njmp +303\nacc +10\nacc -15\njmp +153\nnop +445\nacc -8\nacc +11\njmp +374\nacc +35\nacc -9\nnop +199\njmp +1\njmp +369\njmp +1\nacc +22\nacc -18\nacc +17\njmp +303\nacc +37\nacc +13\nacc +22\nnop +307\njmp +154\nnop +381\nacc -6\nnop -54\nacc +38\njmp +494\nacc +37\nacc +15\njmp +475\njmp +474\nnop +534\nacc +37\njmp +359\njmp +296\nacc +40\njmp +157\nacc +5\nnop +139\nacc +49\nacc +45\njmp +237\nacc +42\nacc +8\nacc +43\njmp +466\nnop +362\nacc +43\nacc +44\njmp +233\nacc +30\nacc +42\nacc -6\njmp -97\njmp +527\nacc +2\nacc +13\nnop +425\njmp +113\nnop +374\nacc +31\njmp +48\nacc +29\nacc +15\nacc +35\njmp +357\nacc +19\nacc -2\njmp +480\nacc +1\njmp +385\nacc +16\nacc +47\njmp +397\njmp +1\njmp +1\nacc +5\nacc -5\njmp +529\nacc +11\njmp +123\nacc +44\nacc +49\njmp +413\nacc +13\nacc +10\nacc -6\nacc +11\njmp -33\nacc +25\nacc +47\nacc +40\nacc +23\njmp +39\nacc +50\nacc +12\njmp +386\nacc +23\njmp +464\nacc +15\nnop +361\nacc +30\njmp +346\njmp +1\nacc +19\nacc +16\nacc +23\njmp +441\njmp +69\nacc +12\nacc +46\nacc -5\njmp +427\nacc +49\nnop +173\nacc -12\njmp +249\nacc +41\nacc +29\nnop +168\nacc +31\njmp +349\nacc +40\nacc +8\nacc +14\njmp +231\nacc -17\njmp +215\nnop +202\nacc +0\nnop +172\njmp +351\nacc +21\nacc +31\nnop +405\nacc +14\njmp +272\nacc +5\nacc +33\nacc +31\nacc +21\njmp -91\nacc -18\nacc +35\njmp +23\nacc -10\nnop +374\nacc +27\njmp -157\nacc +39\nacc +8\nacc +34\nacc +34\njmp +333\njmp -51\nacc -18\nacc +26\njmp +377\nacc -5\njmp +190\nacc +45\njmp +1\nacc +29\njmp +202\nacc +25\nacc +30\njmp +90\nacc +49\nnop +240\njmp +109\njmp +291\nacc +9\njmp +348\nacc +39\njmp +3\njmp +273\njmp -218\njmp +150\njmp +1\njmp +148\nacc +9\nacc +11\nacc +20\nacc +3\njmp -167\nnop +223\njmp +275\nnop +309\njmp +20\nacc -18\nacc -10\nacc -2\njmp +173\nacc +13\nacc -17\nnop +132\nacc -6\njmp +240\nacc +37\nacc +4\nacc +49\nacc -16\njmp +171\njmp +239\nnop +300\nnop +311\nacc -9\njmp -180\nacc +32\nacc +21\njmp +1\njmp -62\nnop +141\nacc +46\nacc +25\nnop -7\njmp +318\nacc +3\njmp +185\nnop +196\nacc +16\nacc +18\njmp -47\nacc +39\nacc +35\nacc +21\nacc +14\njmp +23\nacc +20\nacc +20\njmp +97\nnop -71\nacc +50\nacc -11\njmp -145\nnop -218\nacc +42\nacc +23\nacc +35\njmp +183\nnop +16\nnop -206\nacc +2\nacc +11\njmp +129\nacc +37\nacc +41\nacc +47\nnop -280\njmp +93\nacc -12\nacc +31\njmp +10\nacc +2\nacc +29\njmp +64\nacc -14\nnop +308\njmp -251\nacc +8\nacc +10\njmp +259\nacc +38\nnop -131\nacc +45\njmp +6\nacc +18\nacc +43\nnop -218\nnop -94\njmp +178\njmp +1\nacc +27\nacc +29\njmp +324\nacc -12\nacc +30\njmp +115\nacc -1\njmp -224\njmp +1\njmp +205\nacc +47\njmp -66\nacc +21\nacc +44\njmp +147\nacc +2\nacc +50\nacc -14\nacc +50\njmp -165\nacc +33\nacc +20\nacc -5\nacc +19\njmp -246\nacc +26\nacc +44\njmp -96\nacc +22\njmp +127\nnop +25\nacc -14\nacc -15\njmp -314\njmp +1\nacc +11\nacc +12\njmp +71\nacc +0\nacc +16\nacc +26\nnop +242\njmp -172\nacc +8\nacc +15\nacc -4\njmp -78\nacc +42\njmp +225\nacc -7\njmp +243\njmp +242\nacc +23\nacc +21\njmp +54\nacc +25\njmp -18\njmp -42\njmp +26\njmp -368\nacc +29\nacc +22\nacc +1\nacc +0\njmp +255\nacc +39\njmp +1\nnop -332\nacc +22\njmp +92\nacc +45\nacc +29\njmp +12\njmp +1\nacc +22\njmp +1\njmp -245\njmp -162\nacc -4\nacc -4\njmp +28\nnop -4\njmp -386\njmp -28\nacc -1\nacc +25\nnop -28\njmp -10\nacc +9\nacc +45\njmp +1\nacc +13\njmp -171\nacc +3\nacc +19\nacc -8\nacc +11\njmp -266\nacc -18\nnop -380\njmp -155\nacc +36\nacc -13\nacc +35\nacc -16\njmp -414\nnop -408\njmp +36\nacc +5\njmp +101\nacc -7\nacc +17\njmp -204\nacc -14\njmp -99\njmp +1\nnop -165\nacc +10\nacc +13\njmp +46\nacc -13\njmp -358\nacc -7\nacc -14\njmp -31\nacc +21\nacc -9\njmp -46\nnop -220\nacc -1\njmp -105\nacc +42\nacc -14\njmp -75\nacc +6\njmp -34\nnop -391\nacc -11\njmp -123\nnop -234\nacc -9\nacc +35\njmp -317\nnop +150\nacc +11\njmp +138\nacc +30\nacc -11\nacc +31\njmp -134\nacc +20\njmp -200\nacc +13\nacc +14\nacc +25\njmp -310\nacc +13\nacc +18\nacc -1\njmp +85\njmp +72\nacc +1\njmp -78\nacc -8\njmp -149\nacc +13\njmp -438\nacc +38\nnop -25\njmp -264\nacc +50\nacc +47\nnop -241\nacc +31\njmp -419\njmp +57\nnop -359\njmp -323\nacc +48\nacc +4\nacc -12\nacc +42\njmp -167\nacc +50\nacc -9\njmp -138\nnop -171\nacc +48\njmp -398\nacc -8\nacc +41\nacc +21\njmp -508\nacc +29\nacc +41\nacc +35\nacc +25\njmp -388\njmp -439\nacc +26\nacc +19\nacc +13\nacc -16\njmp -165\nnop -61\nacc +16\nacc +20\njmp -312\nnop -19\njmp -101\nacc +1\njmp -515\nacc +19\njmp +96\njmp +1\nacc +42\nacc +34\nacc +33\njmp +80\nnop -314\nacc +12\nacc +36\nnop -405\njmp -87\nacc +16\nnop -100\nacc +11\nacc +15\njmp -524\nnop -369\nacc +8\njmp -386\nacc +32\njmp -77\nacc -7\nacc -16\nacc +33\nacc +30\njmp -213\nacc -2\njmp -403\nacc +35\nnop -81\njmp -340\nacc +7\nacc +3\njmp -444\njmp -445\njmp -218\nacc +39\nacc -9\njmp +1\njmp -284\nacc +43\nacc +1\nacc -12\nnop -218\njmp -460\njmp -404\njmp +1\njmp -135\njmp -223\njmp +1\nacc +30\nacc +36\njmp -61\njmp -580\nacc -8\njmp -79\nacc +18\nacc -1\nacc +9\njmp -321\njmp -560\nacc +2\njmp -182\nacc +18\nacc +29\nacc +28\njmp -129\nacc +10\nnop -120\njmp +16\nacc +23\nacc +9\nacc +36\nacc +24\njmp -589\nacc +21\njmp -419\nnop -275\njmp -231\njmp -341\nacc +33\nacc +30\njmp -470\nnop -337\njmp -389\njmp +5\nacc -14\nnop -27\nacc +5\njmp -78\nacc +40\nacc +2\nacc -5\nnop -205\njmp -537\njmp -318\nnop -404\nacc +12\nacc +0\nacc -4\njmp -54\nacc +8\nacc +32\nnop -357\nacc +35\njmp -153\nacc +42\nacc +17\nacc -9\njmp -13\nnop -222\nacc +27\njmp -63\nacc +11\nacc -17\nnop -45\nacc +4\njmp -217\nacc +5\nacc +26\nnop -574\njmp -489\nacc +29\nacc +36\nacc +31\nnop -407\njmp +1"
          )
        ) should be(1915)
      }
    }

    "resolveAndAccumulate" should {
      "return the accumulator after running example program" in {
        HandheldHalting.resolveAndAccumulate(
          InputParser.parse[String]("nop +0\nacc +1\njmp +4\nacc +3\njmp -3\nacc -99\nacc +1\njmp -4\nacc +6")
        ) should be(8)
      }

      "return the accumulator after running puzzle program" in {
        HandheldHalting.resolveAndAccumulate(
          InputParser.parse[String](
            "jmp +11\nnop +495\nnop +402\njmp +570\njmp +569\njmp +451\nacc -12\njmp +364\nacc +30\nacc +21\njmp +430\njmp +87\nacc -12\nacc -4\nacc +11\njmp +50\njmp +149\njmp +341\nnop +1\nacc +33\njmp +461\nacc +43\nacc -15\njmp +440\nacc +18\nacc +22\nacc -14\nnop +576\njmp -22\nacc +33\nacc +0\nacc +34\njmp +369\nnop +497\nnop +469\nacc -12\njmp +93\nacc -13\njmp +337\nacc +5\nacc +18\nacc +26\nnop +115\njmp +67\nnop +282\nnop -6\nnop +289\njmp +303\nacc +10\nacc -15\njmp +153\nnop +445\nacc -8\nacc +11\njmp +374\nacc +35\nacc -9\nnop +199\njmp +1\njmp +369\njmp +1\nacc +22\nacc -18\nacc +17\njmp +303\nacc +37\nacc +13\nacc +22\nnop +307\njmp +154\nnop +381\nacc -6\nnop -54\nacc +38\njmp +494\nacc +37\nacc +15\njmp +475\njmp +474\nnop +534\nacc +37\njmp +359\njmp +296\nacc +40\njmp +157\nacc +5\nnop +139\nacc +49\nacc +45\njmp +237\nacc +42\nacc +8\nacc +43\njmp +466\nnop +362\nacc +43\nacc +44\njmp +233\nacc +30\nacc +42\nacc -6\njmp -97\njmp +527\nacc +2\nacc +13\nnop +425\njmp +113\nnop +374\nacc +31\njmp +48\nacc +29\nacc +15\nacc +35\njmp +357\nacc +19\nacc -2\njmp +480\nacc +1\njmp +385\nacc +16\nacc +47\njmp +397\njmp +1\njmp +1\nacc +5\nacc -5\njmp +529\nacc +11\njmp +123\nacc +44\nacc +49\njmp +413\nacc +13\nacc +10\nacc -6\nacc +11\njmp -33\nacc +25\nacc +47\nacc +40\nacc +23\njmp +39\nacc +50\nacc +12\njmp +386\nacc +23\njmp +464\nacc +15\nnop +361\nacc +30\njmp +346\njmp +1\nacc +19\nacc +16\nacc +23\njmp +441\njmp +69\nacc +12\nacc +46\nacc -5\njmp +427\nacc +49\nnop +173\nacc -12\njmp +249\nacc +41\nacc +29\nnop +168\nacc +31\njmp +349\nacc +40\nacc +8\nacc +14\njmp +231\nacc -17\njmp +215\nnop +202\nacc +0\nnop +172\njmp +351\nacc +21\nacc +31\nnop +405\nacc +14\njmp +272\nacc +5\nacc +33\nacc +31\nacc +21\njmp -91\nacc -18\nacc +35\njmp +23\nacc -10\nnop +374\nacc +27\njmp -157\nacc +39\nacc +8\nacc +34\nacc +34\njmp +333\njmp -51\nacc -18\nacc +26\njmp +377\nacc -5\njmp +190\nacc +45\njmp +1\nacc +29\njmp +202\nacc +25\nacc +30\njmp +90\nacc +49\nnop +240\njmp +109\njmp +291\nacc +9\njmp +348\nacc +39\njmp +3\njmp +273\njmp -218\njmp +150\njmp +1\njmp +148\nacc +9\nacc +11\nacc +20\nacc +3\njmp -167\nnop +223\njmp +275\nnop +309\njmp +20\nacc -18\nacc -10\nacc -2\njmp +173\nacc +13\nacc -17\nnop +132\nacc -6\njmp +240\nacc +37\nacc +4\nacc +49\nacc -16\njmp +171\njmp +239\nnop +300\nnop +311\nacc -9\njmp -180\nacc +32\nacc +21\njmp +1\njmp -62\nnop +141\nacc +46\nacc +25\nnop -7\njmp +318\nacc +3\njmp +185\nnop +196\nacc +16\nacc +18\njmp -47\nacc +39\nacc +35\nacc +21\nacc +14\njmp +23\nacc +20\nacc +20\njmp +97\nnop -71\nacc +50\nacc -11\njmp -145\nnop -218\nacc +42\nacc +23\nacc +35\njmp +183\nnop +16\nnop -206\nacc +2\nacc +11\njmp +129\nacc +37\nacc +41\nacc +47\nnop -280\njmp +93\nacc -12\nacc +31\njmp +10\nacc +2\nacc +29\njmp +64\nacc -14\nnop +308\njmp -251\nacc +8\nacc +10\njmp +259\nacc +38\nnop -131\nacc +45\njmp +6\nacc +18\nacc +43\nnop -218\nnop -94\njmp +178\njmp +1\nacc +27\nacc +29\njmp +324\nacc -12\nacc +30\njmp +115\nacc -1\njmp -224\njmp +1\njmp +205\nacc +47\njmp -66\nacc +21\nacc +44\njmp +147\nacc +2\nacc +50\nacc -14\nacc +50\njmp -165\nacc +33\nacc +20\nacc -5\nacc +19\njmp -246\nacc +26\nacc +44\njmp -96\nacc +22\njmp +127\nnop +25\nacc -14\nacc -15\njmp -314\njmp +1\nacc +11\nacc +12\njmp +71\nacc +0\nacc +16\nacc +26\nnop +242\njmp -172\nacc +8\nacc +15\nacc -4\njmp -78\nacc +42\njmp +225\nacc -7\njmp +243\njmp +242\nacc +23\nacc +21\njmp +54\nacc +25\njmp -18\njmp -42\njmp +26\njmp -368\nacc +29\nacc +22\nacc +1\nacc +0\njmp +255\nacc +39\njmp +1\nnop -332\nacc +22\njmp +92\nacc +45\nacc +29\njmp +12\njmp +1\nacc +22\njmp +1\njmp -245\njmp -162\nacc -4\nacc -4\njmp +28\nnop -4\njmp -386\njmp -28\nacc -1\nacc +25\nnop -28\njmp -10\nacc +9\nacc +45\njmp +1\nacc +13\njmp -171\nacc +3\nacc +19\nacc -8\nacc +11\njmp -266\nacc -18\nnop -380\njmp -155\nacc +36\nacc -13\nacc +35\nacc -16\njmp -414\nnop -408\njmp +36\nacc +5\njmp +101\nacc -7\nacc +17\njmp -204\nacc -14\njmp -99\njmp +1\nnop -165\nacc +10\nacc +13\njmp +46\nacc -13\njmp -358\nacc -7\nacc -14\njmp -31\nacc +21\nacc -9\njmp -46\nnop -220\nacc -1\njmp -105\nacc +42\nacc -14\njmp -75\nacc +6\njmp -34\nnop -391\nacc -11\njmp -123\nnop -234\nacc -9\nacc +35\njmp -317\nnop +150\nacc +11\njmp +138\nacc +30\nacc -11\nacc +31\njmp -134\nacc +20\njmp -200\nacc +13\nacc +14\nacc +25\njmp -310\nacc +13\nacc +18\nacc -1\njmp +85\njmp +72\nacc +1\njmp -78\nacc -8\njmp -149\nacc +13\njmp -438\nacc +38\nnop -25\njmp -264\nacc +50\nacc +47\nnop -241\nacc +31\njmp -419\njmp +57\nnop -359\njmp -323\nacc +48\nacc +4\nacc -12\nacc +42\njmp -167\nacc +50\nacc -9\njmp -138\nnop -171\nacc +48\njmp -398\nacc -8\nacc +41\nacc +21\njmp -508\nacc +29\nacc +41\nacc +35\nacc +25\njmp -388\njmp -439\nacc +26\nacc +19\nacc +13\nacc -16\njmp -165\nnop -61\nacc +16\nacc +20\njmp -312\nnop -19\njmp -101\nacc +1\njmp -515\nacc +19\njmp +96\njmp +1\nacc +42\nacc +34\nacc +33\njmp +80\nnop -314\nacc +12\nacc +36\nnop -405\njmp -87\nacc +16\nnop -100\nacc +11\nacc +15\njmp -524\nnop -369\nacc +8\njmp -386\nacc +32\njmp -77\nacc -7\nacc -16\nacc +33\nacc +30\njmp -213\nacc -2\njmp -403\nacc +35\nnop -81\njmp -340\nacc +7\nacc +3\njmp -444\njmp -445\njmp -218\nacc +39\nacc -9\njmp +1\njmp -284\nacc +43\nacc +1\nacc -12\nnop -218\njmp -460\njmp -404\njmp +1\njmp -135\njmp -223\njmp +1\nacc +30\nacc +36\njmp -61\njmp -580\nacc -8\njmp -79\nacc +18\nacc -1\nacc +9\njmp -321\njmp -560\nacc +2\njmp -182\nacc +18\nacc +29\nacc +28\njmp -129\nacc +10\nnop -120\njmp +16\nacc +23\nacc +9\nacc +36\nacc +24\njmp -589\nacc +21\njmp -419\nnop -275\njmp -231\njmp -341\nacc +33\nacc +30\njmp -470\nnop -337\njmp -389\njmp +5\nacc -14\nnop -27\nacc +5\njmp -78\nacc +40\nacc +2\nacc -5\nnop -205\njmp -537\njmp -318\nnop -404\nacc +12\nacc +0\nacc -4\njmp -54\nacc +8\nacc +32\nnop -357\nacc +35\njmp -153\nacc +42\nacc +17\nacc -9\njmp -13\nnop -222\nacc +27\njmp -63\nacc +11\nacc -17\nnop -45\nacc +4\njmp -217\nacc +5\nacc +26\nnop -574\njmp -489\nacc +29\nacc +36\nacc +31\nnop -407\njmp +1"
          )
        ) should be(944)
      }
    }
  }
}
